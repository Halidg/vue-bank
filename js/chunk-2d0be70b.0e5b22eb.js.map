{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?59b5"],"names":["for","class","onSubmit","eError","type","id","email","eBlur","pError","password","pBlur","disabled","isSubmitting","isTooManyAttempts","href","register","useLoginForm","router","useRouter","store","useStore","useForm","handleSubmit","submitCount","useField","yup","trim","required","value","errorMessage","handleBlur","PASSWORD_LENGTH","min","computed","watch","val","setTimeout","values","dispatch","push","setup","route","query","message","error","title","time","__exports__","render"],"mappings":"2IAEM,eAAwB,UAApB,mBAAe,G,EAGf,eAAgC,SAAzBA,IAAI,SAAQ,SAAK,G,YAM1B,eAAsC,SAA/BA,IAAI,YAAW,YAAQ,G,kCAO3BC,MAAM,e,gDAjBf,eAoBO,QApBDA,MAAM,OAAQ,SAAM,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CACxC,EAEA,eAIM,OAJAD,MAAK,wCAA6B,EAAAE,W,CACpC,E,eACA,eAA6D,SAAtDC,KAAK,QAAQC,GAAG,Q,qDAAiB,EAAAC,MAAK,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAd,EAAAD,SAC3B,EAAAH,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGlC,eAIM,OAJAF,MAAK,wCAA6B,EAAAO,W,CACtC,E,eACA,eAAsE,SAA/DJ,KAAK,WAAWC,GAAG,W,qDAAoB,EAAAI,SAAQ,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAjB,EAAAD,YACjC,EAAAD,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGhC,eAAwF,UAAhFP,MAAM,cAAeU,SAAU,EAAAC,cAAgB,EAAAC,mBAAmB,QAAK,KAC/E,eAAqD,KAAlDC,KAAK,IAAK,QAAK,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,eAAE,eACP,EAAAF,mB,iBAA/B,eAEM,MAFN,EAAkD,sD,uICZjD,SAASG,IACZ,IAAMC,EAASC,iBACTC,EAAQC,iBAFa,EAGuBC,iBAA3CC,EAHoB,EAGpBA,aAAcV,EAHM,EAGNA,aAAcW,EAHR,EAGQA,YAHR,EAKqCC,eAC9D,QACAC,SAEGC,OACAC,SAAS,iBACTrB,MAAM,uCANGA,EALa,EAKpBsB,MAA4BzB,EALR,EAKN0B,aAAkCtB,EAL5B,EAKgBuB,WASrCC,EAAkB,EAdG,EAgBwCP,eACjE,WACAC,SAEGC,OACAC,SAAS,kBACTK,IAAID,EAJP,sCAIuDA,EAJvD,eAFYtB,EAhBa,EAgBpBmB,MAA+BpB,EAhBX,EAgBHqB,aAAkCnB,EAhB/B,EAgBmBoB,WASxCjB,EAAoBoB,gBAAS,kBAAMV,EAAYK,OAAS,KAE9DM,eAAMrB,GAAmB,SAAAsB,GACpBA,GACDC,YAAW,kBAAMb,EAAYK,MAAQ,IAAG,QAI5C,IAAM1B,EAAWoB,EAAY,yDAAE,WAAMe,GAAN,0GAErBlB,EAAMmB,SAAS,aAAcD,GAFR,OAG3BpB,EAAOsB,KAAK,KAHe,oIAAF,uDAS7B,MAAO,CACLjC,QACAG,WACAN,SACAK,SACAD,QACAG,QACAR,WACAU,eACAC,qB,gBD5BS,GACb2B,MADa,WAEX,IAAMrB,EAAQ,iBACRsB,EAAQ,iBACRxB,EAAS,iBAWf,MAV2B,SAAxBwB,EAAMC,MAAMC,SACbxB,EAAMmB,SAAS,aAAc,CAC3BK,QAAS,CACPf,MAAO,OAAAgB,EAAA,MAAMH,EAAMC,MAAMC,SACzBE,MAAO,SACPzC,KAAM,WAER0C,KAAM,MAGV,iCACK9B,KADL,IAEED,SAAU,WACRE,EAAOsB,KAAK,kB,qBE1CpB,MAAMQ,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d0be70b.0e5b22eb.js","sourcesContent":["<template>\r\n  <form class=\"card\" @submit.prevent=\"onSubmit\">\r\n      <h1>Войти в систему</h1>\r\n\r\n      <div :class=\"['form-control', {invalid: eError}]\">\r\n          <label for=\"email\">Email</label>\r\n          <input type=\"email\" id=\"email\" v-model=\"email\" @blur=\"eBlur\">\r\n          <small v-if=\"eError\">{{ eError }}</small>\r\n      </div>\r\n\r\n      <div :class=\"['form-control', {invalid: pError}]\">\r\n        <label for=\"password\">Password</label>\r\n        <input type=\"password\" id=\"password\" v-model=\"password\" @blur=\"pBlur\">\r\n        <small v-if=\"pError\">{{ pError }}</small>\r\n      </div>\r\n\r\n      <button class=\"btn primary\" :disabled=\"isSubmitting || isTooManyAttempts\">Войти</button>\r\n      <a href=\"#\" @click.prevent=\"register\">Регистрация</a>\r\n      <div class=\"text-danger\" v-if=\"isTooManyAttempts\">\r\n        Лимит попыток входа в систему. Попробуйте позже\r\n      </div>\r\n  </form>\r\n</template>\r\n\r\n<script>\r\nimport {useLoginForm} from '@/use/login-form.js'\r\nimport {error} from '@/utils/error.js'\r\nimport {useStore} from 'vuex'\r\nimport {useRoute, useRouter} from 'vue-router'\r\nexport default {\r\n  setup() {\r\n    const store = useStore()\r\n    const route = useRoute()\r\n    const router = useRouter()\r\n    if(route.query.message === 'auth') {\r\n      store.dispatch('setMessage', {\r\n        message: {\r\n          value: error(route.query.message),\r\n          title: 'Ошибка',\r\n          type: 'warning'\r\n        },\r\n        time: 10000\r\n      })\r\n    }\r\n    return {\r\n      ...useLoginForm(),\r\n      register: () => {\r\n        router.push('/register')\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>","import {computed, watch} from 'vue'\r\nimport * as yup from 'yup'\r\nimport {useField, useForm} from 'vee-validate'\r\nimport {useStore} from 'vuex'\r\nimport {useRouter} from 'vue-router'\r\n\r\nexport function useLoginForm() {\r\n    const router = useRouter()\r\n    const store = useStore()\r\n    const {handleSubmit, isSubmitting, submitCount} = useForm()\r\n\r\n    const {value: email, errorMessage: eError, handleBlur: eBlur} = useField(\r\n      'email',\r\n      yup\r\n        .string()\r\n        .trim()\r\n        .required('Введите email')\r\n        .email('Необходимо ввести корректный email')\r\n    )\r\n\r\n    const PASSWORD_LENGTH = 6\r\n\r\n    const {value: password, errorMessage: pError, handleBlur: pBlur} = useField(\r\n      'password',\r\n      yup\r\n        .string()\r\n        .trim()\r\n        .required('Введите пароль')\r\n        .min(PASSWORD_LENGTH, `Пароль не может быть меньше ${PASSWORD_LENGTH} символов`)\r\n    )\r\n\r\n    const isTooManyAttempts = computed(() => submitCount.value >= 3)\r\n\r\n    watch(isTooManyAttempts, val => {\r\n      if(val) {\r\n        setTimeout(() => submitCount.value = 0, 3000)\r\n      }\r\n    })\r\n\r\n    const onSubmit = handleSubmit( async values => {\r\n      try {\r\n        await store.dispatch('auth/login', values)\r\n        router.push('/')\r\n      } catch (e) {\r\n        return\r\n      }\r\n    })\r\n\r\n    return {\r\n      email,\r\n      password,\r\n      eError,\r\n      pError,\r\n      eBlur,\r\n      pBlur,\r\n      onSubmit,\r\n      isSubmitting,\r\n      isTooManyAttempts\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n","import { render } from \"./Auth.vue?vue&type=template&id=8e2316e2\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\Comp\\\\Desktop\\\\vue\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}